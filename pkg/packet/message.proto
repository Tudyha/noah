syntax = "proto3";

package packet;

import "google/protobuf/any.proto";

option go_package = "noah/pkg/packet";

message Message {
  string msg_id = 1;
  google.protobuf.Any body = 2;
}

// 用于客户端建立连接后的身份验证
message Login {
  string device_id = 1; // 客户端唯一标识符
  uint64 app_id = 2; // 应用ID
  string sign = 3; // 签名
  
  ClientInfo client_info = 4; // 客户端信息
}

message ClientInfo {
  string hostname = 1; // 主机名
  string username = 2; // 用户名
  string gid = 3; // 组ID
  string uid = 4; // 用户ID
  string os_name = 5; // 操作系统名称
  string os_arch = 6; // 操作系统架构
  uint64 uptime = 7; // 启动时间
  uint64 boot_time = 8; // 引导时间
  string os = 9; // 操作系统
  string platform = 10; // 平台
  string platform_family = 11; // 平台家族
  string platform_version = 12; // 平台版本
  string kernel_version = 13; // 内核版本
  string kernel_arch = 14; // 内核架构
  string host_id = 15; // 主机ID
  int32 cpu_num = 16; // CPU数量
  string cpu_info = 17; // CPU信息
  uint64 mem_total = 18; // 内存总量
  uint64 disk_total = 19; // 磁盘总量
}

// 登录响应
message LoginAck {
  int32 code = 1; // 响应码
  string msg = 2; // 响应信息
}

// 心跳包
message Ping {
  int64 timestamp = 1;
  uint64 mem_free = 2;
  uint64 mem_used = 3;
  double mem_used_percent = 4;
  uint64 mem_available = 5;
  double cpu_percent = 6;
  repeated DiskUsageStat disk_usage = 7;
  double net_bytes_sent = 8;
  double net_bytes_recv = 9;
}

message DiskUsageStat {
  string path = 1;
  string fstype = 2;
  uint64 total = 3;
  uint64 free = 4;
  uint64 used = 5;
  double used_percent = 6;
  uint64 inodes_total = 7;
  uint64 inodes_free = 8;
  uint64 inodes_used = 9;
  double inodes_used_percent = 10;
}

// 登出
message Logout {
  
}

// 打开终端
message OpenTunnel {
  enum TuunnelType {
    UNKNOWN = 0;
    PTY = 1;
    TCP = 2;
    UDP = 3;
  }
  TuunnelType tunnel_type = 1;
  string addr = 2;
}

message OpenTunnelAck {
  int32 code = 1; // 响应码
  string msg = 2; // 响应信息
}